{
	"name": "FlowCustomFieldToSQL_copy1",
	"properties": {
		"type": "MappingDataFlow",
		"typeProperties": {
			"sources": [
				{
					"dataset": {
						"referenceName": "CSVCustomField",
						"type": "DatasetReference"
					},
					"name": "CustomFieldData"
				}
			],
			"sinks": [
				{
					"dataset": {
						"referenceName": "CSVCatalogue",
						"type": "DatasetReference"
					},
					"name": "sink1"
				}
			],
			"transformations": [
				{
					"name": "UnpivotCustomFieldNameValuew"
				},
				{
					"name": "AddUpdateDate"
				},
				{
					"name": "derivedColumn1"
				}
			],
			"script": "parameters{\n\tFileNameDataFlow as string\n}\nsource(output(\n\t\t{LearnignUnitCode (Internal CAP)} as string,\n\t\tLearningName as string,\n\t\tTraningId as string,\n\t\tEventNumberName as string,\n\t\tLastModifiedDate as string,\n\t\tTrainingCreatedDate as string,\n\t\tCreateByName as string,\n\t\tTrainingContact as string,\n\t\tTrainingHours as string,\n\t\tTrainingEmail as string,\n\t\tLearning10 as string,\n\t\tLearning20 as string,\n\t\tLearning70 as string,\n\t\tTrainingStartDate as string,\n\t\tTrainingEndDate as string,\n\t\tEventMinEnroll as string,\n\t\tEventMaxEnrolment as string,\n\t\tTrainingObjective as string,\n\t\tCostName as string,\n\t\tDemandRequire as string,\n\t\tPostAssessment as string,\n\t\tKnowledgeSkill as string,\n\t\tTrainnerName as string,\n\t\tInhousePublic as string,\n\t\tVendorSession as string,\n\t\tLocation as string,\n\t\tTrainingStatus as string\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tignoreNoFilesFound: false) ~> CustomFieldData\nCustomFieldData unpivot(output(\n\t\tCustomFieldName as string,\n\t\tCustomFieldValue as string\n\t),\n\tungroupBy({LearnignUnitCode (Internal CAP)},\n\t\tLearningName),\n\tlateral: false,\n\tignoreNullPivots: true) ~> UnpivotCustomFieldNameValuew\nderivedColumn1 derive(UpdateDate = currentTimestamp()) ~> AddUpdateDate\nUnpivotCustomFieldNameValuew derive(Date = toTimestamp(\r\n    concat(\r\n        /*substring(toString(year(currentDate())),1,2),*/\r\n        substring('CustomField202203011345.csv', 12, 4),'-',\r\n        substring('CustomField202203011345.csv', 16, 2),'-',\r\n        substring('CustomField202203011345.csv', 18, 2),' ',\r\n        substring('CustomField202203011345.csv', 20, 2),':',\r\n        substring('CustomField202203011345.csv', 22, 2)\r\n    )\r\n\r\n,'yyyy-MM-dd HH:mm')) ~> derivedColumn1\nAddUpdateDate sink(allowSchemaDrift: true,\n\tvalidateSchema: false,\n\tinput(\n\t\t{Internal reference} as string,\n\t\t{External reference} as string,\n\t\tName as string,\n\t\tDescription as string,\n\t\t{Content Type} as string,\n\t\t{Display type} as string,\n\t\t{Created on} as string,\n\t\tPriority as string,\n\t\t{Enrolment mode} as string,\n\t\t{Enrolment count} as string,\n\t\t{CPD learning hours} as string,\n\t\t{CPD points} as string,\n\t\t{Access count} as string,\n\t\t{Rating mean} as string,\n\t\t{Rating count} as string,\n\t\t{Visibility:phone} as string,\n\t\t{Visibility:tablet} as string,\n\t\t{Visibility:portal} as string,\n\t\tCategory18 as string,\n\t\tCategory19 as string,\n\t\tCategory20 as string,\n\t\tCategory21 as string,\n\t\tCategory22 as string,\n\t\tCategory23 as string,\n\t\tCategory24 as string,\n\t\tCategory25 as string,\n\t\tCategory26 as string,\n\t\tCategory27 as string,\n\t\tCategory28 as string,\n\t\tCategory29 as string,\n\t\tCategory30 as string,\n\t\tCategory31 as string,\n\t\tCategory32 as string,\n\t\tCategory33 as string,\n\t\tCategory34 as string,\n\t\tCategory35 as string,\n\t\tCategory36 as string,\n\t\tCategory37 as string,\n\t\tCategory38 as string,\n\t\tCategory39 as string,\n\t\tCategory40 as string,\n\t\tCategory41 as string,\n\t\tCategory42 as string,\n\t\tCategory43 as string,\n\t\tCategory44 as string,\n\t\tCategory45 as string,\n\t\tCategory46 as string,\n\t\tCategory47 as string,\n\t\tCategory48 as string,\n\t\tCategory49 as string,\n\t\tCategory50 as string,\n\t\tCategory51 as string,\n\t\tCategory52 as string,\n\t\tCategory53 as string,\n\t\tCategory54 as string,\n\t\tCategory55 as string,\n\t\tCategory56 as string,\n\t\tCategory57 as string,\n\t\tCategory58 as string,\n\t\tCategory59 as string,\n\t\tCategory60 as string,\n\t\tCategory61 as string,\n\t\tCategory62 as string,\n\t\tCategory63 as string,\n\t\tCategory64 as string,\n\t\tCategory65 as string,\n\t\tCategory66 as string,\n\t\tCategory67 as string,\n\t\tCategory68 as string,\n\t\tCategory69 as string,\n\t\tCategory70 as string,\n\t\tCategory71 as string,\n\t\tCategory72 as string,\n\t\tCategory73 as string,\n\t\tCategory74 as string,\n\t\tCategory75 as string,\n\t\tCategory76 as string,\n\t\tCategory77 as string,\n\t\tCategory78 as string,\n\t\tCategory79 as string,\n\t\tCategory80 as string,\n\t\tCategory81 as string,\n\t\tCategory82 as string,\n\t\tCategory83 as string,\n\t\tCategory84 as string,\n\t\tCategory85 as string,\n\t\tCategory86 as string,\n\t\tCategory87 as string,\n\t\tCategory88 as string,\n\t\tCategory89 as string,\n\t\tCategory90 as string,\n\t\tCategory91 as string,\n\t\tCategory92 as string,\n\t\tCategory93 as string,\n\t\tCategory94 as string,\n\t\tCategory95 as string,\n\t\tCategory96 as string,\n\t\tCategory97 as string,\n\t\tCategory98 as string,\n\t\tCategory99 as string,\n\t\tCategory100 as string,\n\t\tCategory101 as string,\n\t\tCategory102 as string,\n\t\tCategory103 as string,\n\t\tCategory104 as string,\n\t\tCategory105 as string,\n\t\tCategory106 as string,\n\t\tCategory107 as string,\n\t\tCategory108 as string,\n\t\tCategory109 as string,\n\t\tCategory110 as string,\n\t\tCategory111 as string,\n\t\tCategory112 as string,\n\t\tCategory113 as string,\n\t\tCategory114 as string,\n\t\tCategory115 as string,\n\t\tCategory116 as string,\n\t\tCategory117 as string,\n\t\tCategory118 as string,\n\t\tCategory119 as string,\n\t\tCategory120 as string,\n\t\tCategory121 as string,\n\t\tCategory122 as string,\n\t\tCategory123 as string,\n\t\tCategory124 as string,\n\t\tCategory125 as string,\n\t\tCategory126 as string,\n\t\tCategory127 as string,\n\t\tCategory128 as string,\n\t\tCategory129 as string,\n\t\tCategory130 as string,\n\t\tCategory131 as string,\n\t\tCategory132 as string,\n\t\tCategory133 as string,\n\t\tCategory134 as string,\n\t\tCategory135 as string,\n\t\tCategory136 as string,\n\t\tCategory137 as string,\n\t\tCategory138 as string,\n\t\tCategory139 as string,\n\t\tCategory140 as string,\n\t\tCategory141 as string,\n\t\tCategory142 as string,\n\t\tCategory143 as string,\n\t\tCategory144 as string,\n\t\tCategory145 as string,\n\t\tCategory146 as string,\n\t\tCategory147 as string,\n\t\t{Catalogue:group148} as string,\n\t\t{Catalogue:group149} as string,\n\t\t{Catalogue:group150} as string,\n\t\t{Catalogue:group151} as string,\n\t\t{Catalogue:group152} as string,\n\t\t{Catalogue:group153} as string,\n\t\t{Catalogue:group154} as string,\n\t\t{Catalogue:group155} as string,\n\t\t{My learning:group156} as string,\n\t\t{My learning:group157} as string,\n\t\t{My learning:group158} as string,\n\t\t{My learning:group159} as string,\n\t\t{My learning:group160} as string,\n\t\t{My learning:group161} as string,\n\t\t{My learning:group162} as string,\n\t\t{My learning:group163} as string,\n\t\t{My learning:group164} as string,\n\t\t{My learning:group165} as string,\n\t\t{Catalogue:ou:business unit description (english)166} as string,\n\t\t{Catalogue:ou:business unit description (english)167} as string,\n\t\t{Catalogue:ou:business unit description (english)168} as string,\n\t\t{Catalogue:ou:business unit description (english)169} as string,\n\t\t{Catalogue:ou:business unit description (english)170} as string,\n\t\t{Catalogue:ou:business unit description (english)171} as string,\n\t\t{Catalogue:ou:business unit description (english)172} as string,\n\t\t{Catalogue:ou:business unit description (english)173} as string,\n\t\t{Catalogue:ou:business unit description (english)174} as string,\n\t\t{Catalogue:ou:business unit description (english)175} as string,\n\t\t{Catalogue:ou:business unit description (english)176} as string,\n\t\t{Catalogue:ou:business unit description (english)177} as string,\n\t\t{Catalogue:ou:business unit description (english)178} as string,\n\t\t{Catalogue:ou:business unit description (english)179} as string,\n\t\t{Catalogue:ou:business unit description (english)180} as string,\n\t\t{Catalogue:ou:business unit description (english)181} as string,\n\t\t{Catalogue:ou:business unit description (english)182} as string,\n\t\t{Catalogue:ou:business unit description (english)183} as string,\n\t\t{Catalogue:ou:business unit description (english)184} as string,\n\t\t{Catalogue:ou:business unit description (english)185} as string,\n\t\t{Catalogue:ou:business unit description (english)186} as string,\n\t\t{Catalogue:ou:business unit description (english)187} as string,\n\t\t{Catalogue:ou:business unit description (english)188} as string,\n\t\t{Catalogue:ou:business unit description (english)189} as string,\n\t\t{Catalogue:ou:business unit description (english)190} as string,\n\t\t{Catalogue:ou:business unit description (english)191} as string,\n\t\t{Catalogue:ou:business unit description (english)192} as string,\n\t\t{Catalogue:ou:business unit description (local)193} as string,\n\t\t{Catalogue:ou:business unit description (local)194} as string,\n\t\t{Catalogue:ou:business unit description (local)195} as string,\n\t\t{Catalogue:ou:business unit description (local)196} as string,\n\t\t{My learning:ou:business unit description (english)197} as string,\n\t\t{My learning:ou:business unit description (english)198} as string,\n\t\t{My learning:ou:business unit description (english)199} as string,\n\t\t{My learning:ou:business unit description (english)200} as string,\n\t\t{My learning:ou:business unit description (english)201} as string,\n\t\t{My learning:ou:business unit description (english)202} as string,\n\t\t{My learning:ou:business unit description (english)203} as string,\n\t\t{My learning:ou:business unit description (english)204} as string,\n\t\t{My learning:ou:business unit description (english)205} as string,\n\t\t{My learning:ou:business unit description (english)206} as string,\n\t\t{My learning:ou:business unit description (english)207} as string,\n\t\t{My learning:ou:business unit description (english)208} as string,\n\t\t{My learning:ou:business unit description (local)} as string\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true,\n\tformat: 'table') ~> sink1"
		}
	}
}